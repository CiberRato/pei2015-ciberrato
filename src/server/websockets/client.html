<!DOCTYPE HTML>
<html>
<head>
    <script type="text/javascript">
        var buffering = [];
        function WebSocketTest() {
            if ("WebSocket" in window) {
                // alert("WebSocket is supported by your Browser!");
                // Let us open a web socket
                var ws = new WebSocket("ws://127.0.0.1:7777/ws");
                var div = document.getElementById('show');

                ws.onopen = function () {
                    ws.send("OK");
                };
                ws.onmessage = function (evt) {
                    var received_msg = evt.data;
                    //div.innerHTML = div.innerHTML + received_msg;
                    //console.log(received_msg);
                    if(buffering.length == 0){
                        console.log(received_msg);
                    }
                    buffering.push(JSON.parse(received_msg));
                    console.log(buffering.length);
                };
                ws.onclose = function () {
                    div.innerHTML = div.innerHTML + "Connection is closed...";
                };
            }
            else {
                // The browser doesn't support WebSocket
                alert("WebSocket NOT supported by your Browser!");
            }
        }
    </script>
</head>
<body>
<div id="sse">
    <a href="javascript:WebSocketTest()">Run WebSocket</a><br/>

    <div id="show"></div>
</div>
</body>
</html>