<div class="content-block" role="main">

    <!-- Page header -->
    <h1 id="row5" style="display: none">WebViewer
        <a class="fam-help" data-toggle="modal" href="#demoModal"></a></h1>
    <div class="modal fade hide" id="demoModal" aria-hidden="true" style="display: none;">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">×</button>
            <h3>Help</h3>
        </div>
        <div class="modal-body">
            <ul>
                <li>You can play, pause or stop the viewer as well as chose the velocity of the simulation.</li>
                <li>Use <i>space</i> key to play or pause simulation and the <i>Left</i> and <i>Right</i> keys to go forward or backward in the timeline.</li>
                <li>You can choose to show or hide the visited points line of each robot.</li>
                <li>The sensors data is only available when the viewer is paused or in the lowest velocity.</li>
            </ul>
        </div>
    </div>
    <!-- /Page header -->

    <div class="row" id="waitawhile">

        <!-- Data block -->
        <article class="span12 data-block">
            <div class="data-container">
                <header>
                    <h2>Wait a while...</h2>
                </header>
                <section>
                    <div class="row">
                        <div class="span12" style="text-align: center">
                            <span class="loading blue" data-original-title="Loading, please wait…">Loading…</span>
                        </div>
                    </div>
                </section>
            </div>
        </article>
        <!-- /Data block -->

    </div>

    <!-- Grid row -->
    <div class="row" id="row1" style="display: none">
        <article class="span12 data-block">
            <div class="data-container">
                <section>
                    <h3>{{vm.teste}}</h3>
                    <div class="row">
                        <div class="span12 viewer" style="text-align: center; vertical-align: middle">
                            <svg  ng-attr-width="{{vm.map._Width*vm.zoom}}" ng-attr-height="{{vm.map._Height*vm.zoom}}" style="background-color: {{vm.groundColor}}" >
                                <g ng-attr-transform="translate(0,{{vm.map._Height*vm.zoom}})">
                                    <g transform="scale(1,-1)">
                                        <g><rect ng-attr-width="{{vm.map._Width*vm.zoom}}" ng-attr-height="{{vm.map._Height*vm.zoom}}" style="fill:blue;stroke:grey;stroke-width:2;fill-opacity:0.0" />
                                            <g ng-repeat="(key, value) in vm.map">

                                                <g ng-if="key == 'Wall'" ng-repeat="(k, v) in value track by $index">
                                                    <!-- Parede grande - original verde-->
                                                    <polygon ng-if="v._Height>=vm.beacon_height" ng-attr-points="{{v.str}}" style=" fill:{{vm.greatWallColor}}" />
                                                    <!-- Parede grande - original azul-->
                                                    <polygon ng-if="v._Height<vm.beacon_height" ng-attr-points="{{v.str}}" style=" fill:{{vm.smallWallColor}}" />
                                                </g>
                                            </g>

                                            <g ng-if="vm.nBeacon != 1" ng-repeat="(i,o) in vm.beacon track by $index">
                                                <circle ng-attr-cx="{{o._X*vm.zoom}}" ng-attr-cy="{{o._Y*vm.zoom}}" ng-attr-r="{{vm.zoom}}" stroke="{{vm.circleBorder}}" stroke-width="2" />
                                                <image ng-attr-x="{{o._X*vm.zoom-vm.zoom}}" ng-attr-y="{{o._Y*vm.zoom-vm.zoom}}" ng-attr-width="{{vm.zoom*2}}" ng-attr-height="{{vm.zoom*2}}" xlink:href="{{vm.cheeseColor}}" />
                                            </g>
                                            <g ng-if="vm.nBeacon == 1">
                                                <circle ng-attr-cx="{{vm.beacon._X*vm.zoom}}" ng-attr-cy="{{vm.beacon._Y*vm.zoom}}" ng-attr-r="{{vm.zoom}}" stroke="{{vm.circleBorder}}" stroke-width="2" />
                                                <image ng-attr-x="{{vm.beacon._X*vm.zoom-vm.zoom}}" ng-attr-y="{{vm.beacon._Y*vm.zoom-vm.zoom}}" ng-attr-width="{{vm.zoom*2}}" ng-attr-height="{{vm.zoom*2}}" xlink:href="{{vm.cheeseColor}}" />
                                            </g>


                                            <g ng-repeat="(key, value) in vm.grid">
                                                <g ng-if="key == 'Position'" ng-repeat="(k, v) in value track by $index">
                                                    <circle ng-attr-cx="{{v._X*vm.zoom}}" ng-attr-cy="{{v._Y*vm.zoom}}" ng-attr-r="{{vm.zoom/2}}" stroke="{{vm.circleBorder}}" stroke-width="2" style=" fill:{{vm.gridColor}}" />
                                                </g>
                                            </g>

                                            <g ng-if="vm.numRobots != 1" ng-repeat="value in vm.robot">
                                                <polyline ng-show="{{vm.slyne[$index]}}" ng-attr-points="{{vm.pline[$index]}}" style="fill:none;stroke:{{vm.lineColor[$index]}} ;stroke-width:3" />
                                                <image ng-if="value.Scores._Collision=='False'" ng-attr-x="{{value.Pos._X*vm.zoom-vm.zoom/2}}" ng-attr-y="{{value.Pos._Y*vm.zoom-vm.zoom/2}}" ng-attr-width="{{vm.zoom}}" ng-attr-height="{{vm.zoom}}" xlink:href="{{vm.robotColor[$index]}}"  ng-attr-transform="rotate({{vm.dir[$index]}},{{value.Pos._X*vm.zoom}},{{value.Pos._Y*vm.zoom}})" />
                                                <image ng-if="value.Scores._Collision=='True'" ng-attr-x="{{value.Pos._X*vm.zoom-vm.zoom/2}}" ng-attr-y="{{value.Pos._Y*vm.zoom-vm.zoom/2}}" ng-attr-width="{{vm.zoom}}" ng-attr-height="{{vm.zoom}}" xlink:href="static/img/svg/mickey_black_smile.svg"  ng-attr-transform="rotate({{vm.dir[$index]}},{{value.Pos._X*vm.zoom}},{{value.Pos._Y*vm.zoom}})" />
                                                <circle  ng-attr-cx="{{value.Pos._X*vm.zoom}}" ng-attr-cy="{{value.Pos._Y*vm.zoom}}" ng-attr-r="{{vm.zoom/2-0.5}}" fill-opacity=0.0 stroke="{{vm.circleBorder}}" stroke-width="1" />

                                                <!--No caso das imagens svg inseridas, tem de se retirar á coordenada x e y da imagem, metade do valor da width e height-->
                                            </g>
                                            <g ng-if="vm.numRobots == 1">
                                                <polyline ng-show="{{vm.slyne[0]}}" ng-attr-points="{{vm.pline[0]}}" style="fill:none;stroke:{{vm.lineColor[0]}} ;stroke-width:3" />
                                                <image ng-if="vm.robot.Scores._Collision=='False'" ng-attr-x="{{vm.robot.Pos._X*vm.zoom-vm.zoom/2}}" ng-attr-y="{{vm.robot.Pos._Y*vm.zoom-vm.zoom/2}}" ng-attr-width="{{vm.zoom}}" ng-attr-height="{{vm.zoom}}" xlink:href="{{vm.robotColor[0]}}"  ng-attr-transform="rotate({{vm.dir[0]}},{{vm.robot.Pos._X*vm.zoom}},{{vm.robot.Pos._Y*vm.zoom}})" />
                                                <image ng-if="vm.robot.Scores._Collision=='True'" ng-attr-x="{{vm.robot.Pos._X*vm.zoom-vm.zoom/2}}" ng-attr-y="{{vm.robot.Pos._Y*vm.zoom-vm.zoom/2}}" ng-attr-width="{{vm.zoom}}" ng-attr-height="{{vm.zoom}}" xlink:href="static/img/svg/mickey_black_smile.svg"  ng-attr-transform="rotate({{vm.dir[0]}},{{vm.robot.Pos._X*vm.zoom}},{{vm.robot.Pos._Y*vm.zoom}})" />
                                                <circle  ng-attr-cx="{{vm.robot.Pos._X*vm.zoom}}" ng-attr-cy="{{vm.robot.Pos._Y*vm.zoom}}" ng-attr-r="{{vm.zoom/2-0.5}}" fill-opacity=0.0 stroke="{{vm.circleBorder}}" stroke-width="1" />

                                                <!--No caso das imagens svg inseridas, tem de se retirar á coordenada x e y da imagem, metade do valor da width e height-->
                                            </g>

                                        </g>
                                    </g>
                                </g>
                            </svg>
                            <div class="nstSlider" data-range_min="0" data-range_max="{{vm.param._SimTime}}"
                                 data-cur_min="0" style="width: {{vm.map._Width*vm.zoom}}px; margin-left: 20px; margin-top: -5px">
                                <div class="leftGrip"></div>
                            </div>

                            <div class="row" >
                                <div class ="span3" style="text-align: left;margin-left: 20px; margin-top: 5px">
                                    <div class="btn-group" data-toggle="buttons-checkbox">
                                        <button class="btn btn-success" ng-click="vm.play()"><span class="awe-play"></span></button>
                                        <button class="btn btn-danger" ng-click="vm.pause()"><span class="awe-pause"></span></button>
                                        <button class="btn btn-info" ng-click="vm.stop()"><span class="awe-stop"></span></button>
                                    </div>
                                </div>

                                <div class="span3" style="text-align: right; margin-top: 5px">
                                    <select id="increments" class="span2">
                                        <option value="1">1</option>
                                        <option value="2">10</option>
                                        <option value="3">100</option>
                                    </select>
                                </div>

                                <div class="span2" style="text-align: right; margin-top: 5px; margin-left: 57px">
                                    <select id="mazeColor" class="span2">
                                        <option value="1">Standard</option>
                                        <option value="2">Black&White</option>
                                    </select>
                                </div>
                                <div class="span3" style="text-align: right; margin-top: 5px">
                                    <div class="btn-group" data-toggle="buttons-checkbox">
                                        <button ng-disabled="vm.velButton=='18x'" class="btn" ng-click="vm.activeV('18x')">1/8x</button>
                                        <button ng-disabled="vm.velButton=='14x'" class="btn" ng-click="vm.activeV('14x')">1/4x</button>
                                        <button ng-disabled="vm.velButton=='1x'" class="btn" ng-click="vm.activeV('1x')">1x</button>
                                        <button ng-disabled="vm.velButton=='2x'" class="btn" ng-click="vm.activeV('2x')">2x</button>
                                        <button ng-disabled="vm.velButton=='4x'" class="btn" ng-click="vm.activeV('4x')">4x</button>
                                    </div>
                                </div>


                            </div>

                        </div>
                    </div>


                </section>
            </div>
        </article>

    </div>
    <!-- /Grid row -->
    <div class="row"  id="row2" style="display: none">
        <article class="span4 data-block">
            <div class="data-container">
                <section class="viewer">
                    <div class="row-fluid demo">
                        <div class="span4">Name</div>
                        <div class="span4">Position</div>
                        <div class="span4">Line</div>

                    </div>
                    <div ng-if="vm.numRobots != 1" ng-repeat="value in vm.robot track by $index" class="row-fluid" style="text-align: center">
                        <div class="span4 viewer"><h2>{{value._Name}}</h2></div>
                        <div class="span4 viewer"><img src="{{vm.robotColor[$index]}}" width="35" height="35"></div>
                        <button ng-click="vm.toggle([$index])" ng-class="vm.bclass[$index]" >{{vm.toggleText[$index]}}</button>
                    </div>
                    <div ng-if="vm.numRobots == 1" class="row-fluid" style="text-align: center">
                        <div class="span4 viewer"><h2>{{vm.robot._Name}}</h2></div>
                        <div class="span4 viewer"><img src="{{vm.robotColor[0]}}" width="35" height="35"></div>
                        <button ng-click="vm.toggle([0])" ng-class="vm.bclass[0]" >{{vm.toggleText[0]}}</button>
                    </div>

                </section>
            </div>
        </article>
        <!-- Data block -->
        <article class="span8 data-block">
            <div class="data-container">
                <section class="viewer">
                    <div class="row-fluid demo">
                        <div class="span2">Time</div>
                        <div class="span2">Collisions</div>
                        <div class="span2">State</div>
                        <div class="span2">Score</div>
                        <div class="span2">Retur. Time</div>
                        <div class="span2">Remaining</div>

                    </div>
                    <div ng-if="vm.numRobots != 1" ng-repeat="value in vm.robot track by $index" class="row-fluid" style="text-align: center">
                        <div class="span2 viewer"><h2>{{vm.time}}</h2></div>
                        <div class="span2 viewer"><h2>{{value.Scores._Collisions}}</h2></div>
                        <div class="span2 viewer"><h2>{{value._State}}</h2></div>
                        <div class="span2 viewer"><h2>{{value.Scores._Score}}</h2></div>
                        <div class="span2 viewer"><h2>{{value.Scores._ReturningTime}}</h2></div>
                        <div class="span2 viewer"><h2>{{vm.param._SimTime-time}}</h2></div>
                    </div>
                    <div ng-if="vm.numRobots == 1" class="row-fluid" style="text-align: center">
                        <div class="span2 viewer"><h2>{{vm.time}}</h2></div>
                        <div class="span2 viewer"><h2>{{vm.robot.Scores._Collisions}}</h2></div>
                        <div class="span2 viewer"><h2>{{vm.robot._State}}</h2></div>
                        <div class="span2 viewer"><h2>{{vm.robot.Scores._Score}}</h2></div>
                        <div class="span2 viewer"><h2>{{vm.robot.Scores._ReturningTime}}</h2></div>
                        <div class="span2 viewer"><h2>{{vm.param._SimTime-time}}</h2></div>
                    </div>


                </section>
            </div>
        </article>
    </div>
    <!-- Grid row -->

    <div class="row"  id="row3" style="display: none">
        <article class="span12 data-block accordion-block decent">
            <div class="data-container">
                <div class="accordion">
                    <div class="accordion-group">
                        <div class="accordion-heading">
                            <a class="accordion-toggle" href="#sotable" data-parent="#icons" data-toggle="collapse"><h2>Sensors Data</h2></a>
                        </div>
                        <div id="sotable" class="accordion-body collapse">
                            <div class="row" >
                                <div ng-if="vm.playvar == 1 && vm.slow == 0" style="text-align: center"><h3>Only available when the viewer is paused or in the lowest velocity </h3> </div>
                                <table ng-if="vm.playvar == 0 || vm.slow == 1" id="scoretable" class="table table-striped table-bordered table-condensed table-hover" >
                                    <colgroup>
                                        <col style="width: 15%" />
                                        <col style="width: 17%" />
                                        <col style="width: 17%" />
                                        <col style="width: 17%" />
                                        <col style="width: 17%" />
                                        <col style="width: 17%" />
                                    </colgroup>
                                    <thead>
                                    <tr>
                                        <th></th>
                                        <th ng-repeat="value in vm.robot track by $index" style="text-align: center">{{value._Id}} - {{value._Name}}</th>
                                    </tr>
                                    </thead>
                                    <tbody>

                                    <!-- Position(x,y) -->
                                    <tr ng-if="vm.robot[0].Pos">
                                        <th>Position(x,y)</th>
                                        <td ng-repeat="value in vm.robot track by $index" style="text-align: center">({{value.Pos._X | number:2}}, {{value.Pos._Y | number:2}})</td>
                                    </tr>

                                    <!-- Direction -->
                                    <tr ng-if="vm.robot[0].Pos">
                                        <th>Direction</th>
                                        <td ng-repeat="value in vm.robot track by $index" style="text-align: center">{{value.Pos._Dir | number:2}}</td>
                                    </tr>

                                    <!-- Compass -->
                                    <tr ng-if="vm.robot[0].Measures.Sensors.hasOwnProperty('_Compass')">
                                        <th>Compass</th>
                                        <td ng-repeat="value in vm.robot track by $index" style="text-align: center">{{value.Measures.Sensors._Compass}}</td>
                                    </tr>

                                    <!-- Left Motor -->
                                    <tr ng-if="vm.robot[0].Action.hasOwnProperty('_LeftMotor')">
                                        <th>Left Motor</th>
                                        <td ng-repeat="value in vm.robot track by $index" style="text-align: center">{{value.Action._LeftMotor}}</td>
                                    </tr>

                                    <!-- Right Motor -->
                                    <tr ng-if="vm.robot[0].Action.hasOwnProperty('_RightMotor')">
                                        <th>Right Motor</th>
                                        <td ng-repeat="value in vm.robot track by $index" style="text-align: center">{{value.Action._RightMotor}}</td>
                                    </tr>

                                    <!-- Collision -->
                                    <tr ng-if="vm.robot[0].Measures.Sensors.hasOwnProperty('_Collision')">
                                        <th>Collision</th>
                                        <td ng-repeat="value in vm.robot track by $index" style="text-align: center">{{value.Measures.Sensors._Collision}}</td>
                                    </tr>

                                    <!-- Ground -->
                                    <tr ng-if="vm.robot[0].Measures.Sensors.hasOwnProperty('_Ground')">
                                        <th>Ground</th>
                                        <td ng-repeat="value in vm.robot track by $index" style="text-align: center">{{value.Measures.Sensors._Ground}}</td>
                                    </tr>

                                    <!-- IRSensors -->
                                    <tr ng-if="vm.robot[0].Measures.Sensors.IRSensor" ng-repeat="(idx, ir) in vm.robot[0].Measures.Sensors.IRSensor">
                                        <th>IRSensor {{vm.robot[0].Measures.Sensors.IRSensor[idx]._Id}}</th>
                                        <td ng-repeat="value in vm.robot" style="text-align: center">{{value.Measures.Sensors.IRSensor[idx]._Value}}</td>
                                    </tr>

                                    <!-- GPS(x,y) -->
                                    <tr ng-if="vm.robot[0].Measures.Sensors.GPS">
                                        <th>GPS(x,y)</th>
                                        <td ng-repeat="value in vm.robot track by $index" style="text-align: center">({{value.Measures.Sensors.GPS._X}}, {{value.Measures.Sensors.GPS._Y}})</td>
                                    </tr>

                                    <!-- End Led -->
                                    <tr>
                                        <th>End Led</th>
                                        <td ng-repeat="value in vm.robot track by $index" style="text-align: center">
                                            <span ng-if="value.Measures.Leds._EndLed=='Off'" class="label label-important">OFF</span>
                                            <span ng-if="value.Measures.Leds._EndLed=='On'" class="label label-success">ON</span>
                                        </td>
                                    </tr>

                                    <!-- Returning Led -->
                                    <tr>
                                        <th>Returning Led</th>
                                        <td ng-repeat="value in vm.robot track by $index" style="text-align: center">
                                            <span ng-if="value.Measures.Leds._ReturningLed=='Off'" class="label label-important">OFF</span>
                                            <span ng-if="value.Measures.Leds._ReturningLed=='On'" class="label label-success">ON</span>
                                        </td>
                                    </tr>

                                    <!-- Visiting Led -->
                                    <tr>
                                        <th>Visiting Led</th>
                                        <td ng-repeat="value in vm.robot track by $index" style="text-align: center">
                                            <span ng-if="value.Measures.Leds._VisitingLed=='Off'" class="label label-important">OFF</span>
                                            <span ng-if="value.Measures.Leds._VisitingLed=='On'" class="label label-success">ON</span>
                                        </td>
                                    </tr>

                                    </tbody>
                                </table>


                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </article>
    </div>
</div>

